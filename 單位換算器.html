<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¬èƒ½å–®ä½æ›ç®—å™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .glass-effect { 
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .category-card:hover { transform: translateY(-2px); transition: all 0.3s ease; }
        .input-focus:focus { box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1); }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-white mb-2">ğŸ”„ è¬èƒ½å–®ä½æ›ç®—å™¨</h1>
            <p class="text-white/80 text-lg">å¿«é€Ÿæº–ç¢ºçš„å–®ä½è½‰æ›å·¥å…·</p>
        </div>

        <!-- Category Selection -->
        <div class="glass-effect rounded-2xl p-6 mb-8">
            <h2 class="text-xl font-semibold text-white mb-4">é¸æ“‡æ›ç®—é¡åˆ¥</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-3">
                <button onclick="selectCategory('length')" class="category-card bg-blue-500/20 hover:bg-blue-500/30 text-white p-4 rounded-xl text-center transition-all duration-300">
                    <div class="text-2xl mb-2">ğŸ“</div>
                    <div class="text-sm font-medium">é•·åº¦</div>
                </button>
                <button onclick="selectCategory('mass')" class="category-card bg-green-500/20 hover:bg-green-500/30 text-white p-4 rounded-xl text-center transition-all duration-300">
                    <div class="text-2xl mb-2">âš–ï¸</div>
                    <div class="text-sm font-medium">è³ªé‡/é‡é‡</div>
                </button>
                <button onclick="selectCategory('volume')" class="category-card bg-purple-500/20 hover:bg-purple-500/30 text-white p-4 rounded-xl text-center transition-all duration-300">
                    <div class="text-2xl mb-2">ğŸ§ª</div>
                    <div class="text-sm font-medium">å®¹ç©/é«”ç©</div>
                </button>
                <button onclick="selectCategory('temperature')" class="category-card bg-red-500/20 hover:bg-red-500/30 text-white p-4 rounded-xl text-center transition-all duration-300">
                    <div class="text-2xl mb-2">ğŸŒ¡ï¸</div>
                    <div class="text-sm font-medium">æº«åº¦</div>
                </button>
                <button onclick="selectCategory('energy')" class="category-card bg-yellow-500/20 hover:bg-yellow-500/30 text-white p-4 rounded-xl text-center transition-all duration-300">
                    <div class="text-2xl mb-2">âš¡</div>
                    <div class="text-sm font-medium">èƒ½é‡</div>
                </button>
                <button onclick="selectCategory('speed')" class="category-card bg-indigo-500/20 hover:bg-indigo-500/30 text-white p-4 rounded-xl text-center transition-all duration-300">
                    <div class="text-2xl mb-2">ğŸš—</div>
                    <div class="text-sm font-medium">é€Ÿåº¦</div>
                </button>
                <button onclick="selectCategory('electrical')" class="category-card bg-orange-500/20 hover:bg-orange-500/30 text-white p-4 rounded-xl text-center transition-all duration-300">
                    <div class="text-2xl mb-2">ğŸ”‹</div>
                    <div class="text-sm font-medium">é›»å­¸å–®ä½</div>
                </button>
                <button onclick="selectCategory('currency')" class="category-card bg-pink-500/20 hover:bg-pink-500/30 text-white p-4 rounded-xl text-center transition-all duration-300">
                    <div class="text-2xl mb-2">ğŸ’°</div>
                    <div class="text-sm font-medium">è²¨å¹£</div>
                </button>
            </div>
        </div>

        <!-- Converter Interface -->
        <div id="converterInterface" class="glass-effect rounded-2xl p-6 hidden">
            <div class="flex items-center justify-between mb-6">
                <h2 id="categoryTitle" class="text-2xl font-semibold text-white"></h2>
                <button onclick="clearAll()" class="bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg transition-colors">
                    ğŸ—‘ï¸ æ¸…é™¤
                </button>
            </div>

            <div class="grid md:grid-cols-2 gap-6">
                <!-- From Unit -->
                <div class="space-y-4">
                    <label class="block text-white font-medium">å¾</label>
                    <select id="fromUnit" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 text-white input-focus" onchange="convert()">
                    </select>
                    <input id="fromValue" type="number" placeholder="è¼¸å…¥æ•¸å€¼" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 text-white placeholder-white/60 input-focus" oninput="convert()">
                </div>

                <!-- To Unit -->
                <div class="space-y-4">
                    <label class="block text-white font-medium">è½‰æ›ç‚º</label>
                    <select id="toUnit" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 text-white input-focus" onchange="convert()">
                    </select>
                    <input id="toValue" type="number" placeholder="è½‰æ›çµæœ" class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 text-white placeholder-white/60 input-focus" readonly>
                </div>
            </div>

            <!-- Quick Convert Buttons -->
            <div id="quickButtons" class="mt-6 flex flex-wrap gap-2"></div>

            <!-- Currency Notice -->
            <div id="currencyNotice" class="mt-4 p-4 bg-yellow-500/20 border border-yellow-500/30 rounded-lg text-yellow-100 text-sm hidden">
                ğŸ’¡ è²¨å¹£åŒ¯ç‡ç‚ºç¤ºç¯„æ•¸æ“šï¼Œå¯¦éš›åŒ¯ç‡è«‹åƒè€ƒé‡‘èæ©Ÿæ§‹è³‡è¨Š
            </div>

            <!-- Refresh Rate Button -->
            <div id="refreshRateButton" class="mt-4 text-center hidden">
                <button onclick="refreshExchangeRates()" class="bg-green-500/20 hover:bg-green-500/30 text-white px-4 py-2 rounded-lg transition-colors">
                    ğŸ”„ åˆ·æ–°åŒ¯ç‡
                </button>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-8 text-white/60">
            <p>è¬èƒ½å–®ä½æ›ç®—å™¨ - è®“æ›ç®—è®Šå¾—ç°¡å–®</p>
        </div>
    </div>

    <script>
        // å–®ä½å®šç¾©å’Œè½‰æ›ä¿‚æ•¸
        const units = {
            length: {
                title: 'ğŸ“ é•·åº¦æ›ç®—',
                units: {
                    'm': { name: 'å…¬å°º (m)', factor: 1 },
                    'cm': { name: 'å…¬åˆ† (cm)', factor: 0.01 },
                    'mm': { name: 'æ¯«ç±³ (mm)', factor: 0.001 },
                    'inch': { name: 'è‹±å‹ (inch)', factor: 0.0254 },
                    'ft': { name: 'è‹±å°º (ft)', factor: 0.3048 },
                    'yard': { name: 'ç¢¼ (yard)', factor: 0.9144 },
                    'mile': { name: 'å“© (mile)', factor: 1609.344 },
                    'nautical_mile': { name: 'æµ·é‡Œ (nautical mile)', factor: 1852 }
                }
            },
            mass: {
                title: 'âš–ï¸ è³ªé‡/é‡é‡æ›ç®—',
                units: {
                    'g': { name: 'å…¬å…‹ (g)', factor: 1 },
                    'kg': { name: 'åƒå…‹ (kg)', factor: 1000 },
                    'mg': { name: 'æ¯«å…‹ (mg)', factor: 0.001 },
                    't': { name: 'å…¬å™¸ (t)', factor: 1000000 },
                    'lb': { name: 'è‹±ç£… (lb)', factor: 453.592 },
                    'oz': { name: 'ç›å¸ (oz)', factor: 28.3495 },
                    'short_ton': { name: 'è‹±å™¸ (short ton)', factor: 907185 }
                }
            },
            volume: {
                title: 'ğŸ§ª å®¹ç©/é«”ç©æ›ç®—',
                units: {
                    'L': { name: 'å…¬å‡ (L)', factor: 1 },
                    'mL': { name: 'æ¯«å‡ (mL)', factor: 0.001 },
                    'm3': { name: 'ç«‹æ–¹å…¬å°º (mÂ³)', factor: 1000 },
                    'cm3': { name: 'ç«‹æ–¹å…¬åˆ† (cmÂ³)', factor: 0.001 },
                    'uk_gallon': { name: 'è‹±åŠ ä¾– (UK gallon)', factor: 4.546 },
                    'us_gallon': { name: 'ç¾åŠ ä¾– (US gallon)', factor: 3.785 },
                    'pint': { name: 'å“è„« (pint)', factor: 0.568 },
                    'cup': { name: 'æ¯ (cup)', factor: 0.237 }
                }
            },
            temperature: {
                title: 'ğŸŒ¡ï¸ æº«åº¦æ›ç®—',
                special: true,
                units: {
                    'celsius': { name: 'æ”æ° (Â°C)' },
                    'fahrenheit': { name: 'è¯æ° (Â°F)' },
                    'kelvin': { name: 'çµ•å°æº«æ¨™ (K)' },
                    'rankine': { name: 'Rankine (Â°R)' }
                }
            },
            energy: {
                title: 'âš¡ èƒ½é‡æ›ç®—',
                units: {
                    'J': { name: 'ç„¦è€³ (J)', factor: 1 },
                    'kJ': { name: 'åƒç„¦ (kJ)', factor: 1000 },
                    'cal': { name: 'å¡è·¯é‡Œ (cal)', factor: 4.184 },
                    'kcal': { name: 'å¤§å¡ (kcal)', factor: 4184 },
                    'btu': { name: 'è‹±åˆ¶ç†±é‡å–®ä½ (BTU)', factor: 1055.06 }
                }
            },
            speed: {
                title: 'ğŸš— é€Ÿåº¦æ›ç®—',
                units: {
                    'ms': { name: 'å…¬å°º/ç§’ (m/s)', factor: 1 },
                    'kmh': { name: 'å…¬é‡Œ/å°æ™‚ (km/h)', factor: 0.2778 },
                    'mph': { name: 'è‹±å“©/å°æ™‚ (mph)', factor: 0.4470 },
                    'knot': { name: 'ç¯€ (knot)', factor: 0.5144 }
                }
            },
            electrical: {
                title: 'ğŸ”‹ é›»å­¸å–®ä½æ›ç®—',
                units: {
                    'V': { name: 'ä¼ç‰¹ (V)', factor: 1 },
                    'mV': { name: 'æ¯«ä¼ (mV)', factor: 0.001 },
                    'kV': { name: 'åƒä¼ (kV)', factor: 1000 },
                    'A': { name: 'å®‰åŸ¹ (A)', factor: 1 },
                    'mA': { name: 'æ¯«å®‰ (mA)', factor: 0.001 },
                    'ohm': { name: 'æ­å§† (Î©)', factor: 1 },
                    'W': { name: 'ç“¦ç‰¹ (W)', factor: 1 },
                    'kW': { name: 'åƒç“¦ (kW)', factor: 1000 }
                }
            },
            currency: {
                title: 'ğŸ’° è²¨å¹£æ›ç®—',
                special: true,
                units: {
                    'USD': { name: 'ç¾å…ƒ (USD)', rate: 1 },
                    'EUR': { name: 'æ­å…ƒ (EUR)', rate: 1 },
                    'JPY': { name: 'æ—¥åœ“ (JPY)', rate: 1 },
                    'CNY': { name: 'äººæ°‘å¹£ (CNY)', rate: 1 },
                    'TWD': { name: 'æ–°å°å¹£ (TWD)', rate: 1 },
                    'GBP': { name: 'è‹±éŠ (GBP)', rate: 1 },
                    'KRW': { name: 'éŸ“åœ“ (KRW)', rate: 1 },
                    'HKD': { name: 'æ¸¯å¹£ (HKD)', rate: 1 },
                    'SGD': { name: 'æ–°åŠ å¡å¹£ (SGD)', rate: 1 },
                    'AUD': { name: 'æ¾³å¹£ (AUD)', rate: 1 },
                    'CAD': { name: 'åŠ å¹£ (CAD)', rate: 1 },
                    'CHF': { name: 'ç‘å£«æ³•éƒ (CHF)', rate: 1 }
                }
            }
        };
        // API!!!è«‹èª¤å‹•!!!
        let currentCategory = null;
        const API_KEY = '17ff54a0330df529555923fd';
        let exchangeRates = {};
        let lastRateUpdate = null;

        // è¼‰å…¥å³æ™‚åŒ¯ç‡
        async function loadExchangeRates() {
            try {
                const response = await fetch(`https://v6.exchangerate-api.com/v6/${API_KEY}/latest/USD`);
                const data = await response.json();
                
                if (data.result === 'success') {
                    exchangeRates = data.conversion_rates;
                    lastRateUpdate = new Date();
                    updateCurrencyNotice();
                    return true;
                }
            } catch (error) {
                console.error('è¼‰å…¥åŒ¯ç‡å¤±æ•—:', error);
                showRateError();
            }
            return false;
        }

        function updateCurrencyNotice() {
            const notice = document.getElementById('currencyNotice');
            if (lastRateUpdate) {
                const timeStr = lastRateUpdate.toLocaleString('zh-TW');
                notice.innerHTML = `ğŸ’¡ åŒ¯ç‡æ›´æ–°æ™‚é–“: ${timeStr} (æ•¸æ“šä¾†æº: ExchangeRate-API)`;
            }
        }

        function showRateError() {
            const notice = document.getElementById('currencyNotice');
            notice.innerHTML = `âš ï¸ ç„¡æ³•è¼‰å…¥å³æ™‚åŒ¯ç‡ï¼Œä½¿ç”¨é è¨­åŒ¯ç‡é€²è¡Œæ›ç®—`;
            notice.className = notice.className.replace('yellow-500', 'red-500');
        }

        function selectCategory(category) {
            currentCategory = category;
            const categoryData = units[category];
            
            document.getElementById('categoryTitle').textContent = categoryData.title;
            document.getElementById('converterInterface').classList.remove('hidden');
            
            // å¡«å……å–®ä½é¸é …
            const fromUnit = document.getElementById('fromUnit');
            const toUnit = document.getElementById('toUnit');
            
            fromUnit.innerHTML = '';
            toUnit.innerHTML = '';
            
            Object.keys(categoryData.units).forEach(key => {
                const unit = categoryData.units[key];
                fromUnit.innerHTML += `<option value="${key}">${unit.name}</option>`;
                toUnit.innerHTML += `<option value="${key}">${unit.name}</option>`;
            });
            
            // è¨­ç½®é»˜èªé¸é …
            if (toUnit.children.length > 1) {
                toUnit.selectedIndex = 1;
            }
            
            // é¡¯ç¤ºè²¨å¹£æç¤ºä¸¦è¼‰å…¥åŒ¯ç‡
            const currencyNotice = document.getElementById('currencyNotice');
            const refreshButton = document.getElementById('refreshRateButton');
            if (category === 'currency') {
                currencyNotice.classList.remove('hidden');
                refreshButton.classList.remove('hidden');
                currencyNotice.className = 'mt-4 p-4 bg-yellow-500/20 border border-yellow-500/30 rounded-lg text-yellow-100 text-sm';
                currencyNotice.innerHTML = 'ğŸ”„ æ­£åœ¨è¼‰å…¥å³æ™‚åŒ¯ç‡...';
                loadExchangeRates();
            } else {
                currencyNotice.classList.add('hidden');
                refreshButton.classList.add('hidden');
            }
            
            // ç”Ÿæˆå¿«é€Ÿè½‰æ›æŒ‰éˆ•
            generateQuickButtons(category);
            
            // æ¸…é™¤è¼¸å…¥
            document.getElementById('fromValue').value = '';
            document.getElementById('toValue').value = '';
        }

        function generateQuickButtons(category) {
            const quickButtons = document.getElementById('quickButtons');
            quickButtons.innerHTML = '';
            
            const commonValues = {
                length: [1, 10, 100, 1000],
                mass: [1, 100, 1000],
                volume: [1, 10, 100, 1000],
                temperature: [0, 25, 100],
                energy: [1, 100, 1000],
                speed: [1, 10, 60, 100],
                electrical: [1, 12, 110, 220],
                currency: [1, 10, 100, 1000]
            };
            
            if (commonValues[category]) {
                commonValues[category].forEach(value => {
                    const button = document.createElement('button');
                    button.className = 'bg-white/20 hover:bg-white/30 text-white px-3 py-1 rounded-lg text-sm transition-colors';
                    button.textContent = value;
                    button.onclick = () => {
                        document.getElementById('fromValue').value = value;
                        convert();
                    };
                    quickButtons.appendChild(button);
                });
            }
        }

        function convert() {
            const fromValue = parseFloat(document.getElementById('fromValue').value);
            const fromUnit = document.getElementById('fromUnit').value;
            const toUnit = document.getElementById('toUnit').value;
            const toValueInput = document.getElementById('toValue');
            
            if (isNaN(fromValue) || fromValue === '') {
                toValueInput.value = '';
                return;
            }
            
            const categoryData = units[currentCategory];
            let result;
            
            if (currentCategory === 'temperature') {
                result = convertTemperature(fromValue, fromUnit, toUnit);
            } else if (currentCategory === 'currency') {
                result = convertCurrency(fromValue, fromUnit, toUnit);
            } else {
                // æ¨™æº–å–®ä½è½‰æ›
                const fromFactor = categoryData.units[fromUnit].factor;
                const toFactor = categoryData.units[toUnit].factor;
                result = (fromValue * fromFactor) / toFactor;
            }
            
            toValueInput.value = result.toFixed(6).replace(/\.?0+$/, '');
        }

        function convertTemperature(value, from, to) {
            // å…ˆè½‰æ›ç‚ºæ”æ°åº¦
            let celsius;
            switch (from) {
                case 'celsius': celsius = value; break;
                case 'fahrenheit': celsius = (value - 32) * 5/9; break;
                case 'kelvin': celsius = value - 273.15; break;
                case 'rankine': celsius = (value - 491.67) * 5/9; break;
            }
            
            // å¾æ”æ°åº¦è½‰æ›ç‚ºç›®æ¨™å–®ä½
            switch (to) {
                case 'celsius': return celsius;
                case 'fahrenheit': return celsius * 9/5 + 32;
                case 'kelvin': return celsius + 273.15;
                case 'rankine': return celsius * 9/5 + 491.67;
            }
        }

        function convertCurrency(value, from, to) {
            // ä½¿ç”¨å³æ™‚åŒ¯ç‡ï¼ˆå¦‚æœå¯ç”¨ï¼‰
            if (Object.keys(exchangeRates).length > 0) {
                const fromRate = exchangeRates[from] || 1;
                const toRate = exchangeRates[to] || 1;
                return (value / fromRate) * toRate;
            } else {
                // å‚™ç”¨é è¨­åŒ¯ç‡
                const defaultRates = {
                    'USD': 1, 'EUR': 0.85, 'JPY': 110, 'CNY': 6.45, 'TWD': 28.5,
                    'GBP': 0.73, 'KRW': 1180, 'HKD': 7.8, 'SGD': 1.35, 'AUD': 1.35,
                    'CAD': 1.25, 'CHF': 0.92
                };
                const fromRate = defaultRates[from] || 1;
                const toRate = defaultRates[to] || 1;
                return (value / fromRate) * toRate;
            }
        }

        function clearAll() {
            document.getElementById('fromValue').value = '';
            document.getElementById('toValue').value = '';
        }

        async function refreshExchangeRates() {
            const notice = document.getElementById('currencyNotice');
            notice.innerHTML = 'ğŸ”„ æ­£åœ¨æ›´æ–°åŒ¯ç‡...';
            notice.className = 'mt-4 p-4 bg-blue-500/20 border border-blue-500/30 rounded-lg text-blue-100 text-sm';
            
            const success = await loadExchangeRates();
            if (success) {
                // é‡æ–°è¨ˆç®—ç•¶å‰è½‰æ›
                convert();
            }
        }

        // æ”¯æŒåå‘è¼¸å…¥
        document.getElementById('toValue').addEventListener('input', function() {
            if (this.readOnly) return;
            
            const toValue = parseFloat(this.value);
            const fromUnit = document.getElementById('fromUnit').value;
            const toUnit = document.getElementById('toUnit').value;
            const fromValueInput = document.getElementById('fromValue');
            
            if (isNaN(toValue) || toValue === '') {
                fromValueInput.value = '';
                return;
            }
            
            const categoryData = units[currentCategory];
            let result;
            
            if (currentCategory === 'temperature') {
                result = convertTemperature(toValue, toUnit, fromUnit);
            } else if (currentCategory === 'currency') {
                result = convertCurrency(toValue, toUnit, fromUnit);
            } else {
                const fromFactor = categoryData.units[fromUnit].factor;
                const toFactor = categoryData.units[toUnit].factor;
                result = (toValue * toFactor) / fromFactor;
            }
            
            fromValueInput.value = result.toFixed(6).replace(/\.?0+$/, '');
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9783da8be144f1bc',t:'MTc1NjcyMDEyNS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
